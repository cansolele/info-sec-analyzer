import React from "react";
import { Box, Typography } from "@mui/material";
import VulnerabilityTable from "./VulnerabilityTable";
import VulnerabilityDiagram from "./VulnerabilityDiagram";
import ProductTable from "./ProductTable";
const VulnerabilityReport = React.memo(({ currentLanguage, scanInfo }) => {
  return (
    <Box sx={{ ml: "360px", maxWidth: "80%" }}>
      {scanInfo ? (
        <Box sx={{}}>
          <Typography variant="body1" sx={{}}>
            {currentLanguage === "ENG"
              ? "This type of audit performs automated scanning of operating systems, system-wide and application software in order to identify and assess the criticality of vulnerabilities that could be exploited by attackers to gain unauthorized access to protected information, system components, or to conduct a computer attack."
              : "Данный тип аудита производит автоматизированное сканирование операционных систем, общесистемного и прикладного ПО с целью выявления и оценки критичности уязвимостей, которые могут быть использованы нарушителями для несанкционированного доступа к защищаемой информации, компонентам системы или совершения компьютерной атаки."}
          </Typography>

          <Typography variant="body1" sx={{ mt: 2 }}>
            <Box component="span" sx={{ fontWeight: "bold" }}>
              {currentLanguage === "ENG"
                ? "Creation time: "
                : "Формирование отчета: "}
            </Box>
            {scanInfo.creation_time}
          </Typography>

          <Typography variant="body1" sx={{ mt: 2 }}>
            <Box component="span" sx={{ fontWeight: "bold" }}>
              {currentLanguage === "ENG"
                ? "Start/End Scan: "
                : "Начало/завершение сканирования: "}
            </Box>
            {`${scanInfo.start_time} / ${scanInfo.end_time}`}
          </Typography>

          <Typography variant="body1" sx={{ mt: 2 }}>
            <Box component="span" sx={{ fontWeight: "bold" }}>
              {currentLanguage === "ENG" ? "Hosts: " : "Хосты: "}
            </Box>
            {scanInfo.target_hosts}
          </Typography>
          <Typography variant="body1" sx={{ mt: 2, mb: 1, fontWeight: "bold" }}>
            {currentLanguage === "ENG"
              ? "Table of Vulnerability Distribution by Hosts"
              : "Таблица распределения уязвимостей по хостам"}
          </Typography>

          <VulnerabilityTable
            currentLanguage={currentLanguage}
            vulnerabilityData={scanInfo.vulnerabilities}
          />
          <Typography variant="body1" sx={{ mt: 5, mb: 1, fontWeight: "bold" }}>
            {currentLanguage === "ENG"
              ? "Table of Vulnerability Distribution by Products"
              : "Таблица распределения уязвимостей по продуктам"}
          </Typography>

          <ProductTable
            currentLanguage={currentLanguage}
            vulnerabilityData={scanInfo.products}
          />
          <VulnerabilityDiagram
            vulnerabilityData={scanInfo.vulnerabilities}
            currentLanguage={currentLanguage}
            percent={scanInfo.percent}
          />
        </Box>
      ) : (
        <Typography variant="body1" sx={{}}>
          {currentLanguage === "ENG"
            ? "No scan information available"
            : "Информация о сканировании недоступна"}
        </Typography>
      )}
    </Box>
  );
});

export default VulnerabilityReport;
