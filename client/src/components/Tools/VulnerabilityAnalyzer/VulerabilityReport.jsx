import React from "react";
import { Box, Typography } from "@mui/material";
import VulnerabilityTable from "./VulnerabilityTable";
import VulnerabilityDiagram from "./VulnerabilityDiagram";
import ProductTable from "./ProductTable";
const VulerabilityReport = React.memo(({ currentLanguage, scanInfo }) => {
  return (
    <Box>
      {scanInfo ? (
        <Box sx={{ textAlign: "center", maxWidth: "1200px", mx: "auto" }}>
          <Typography variant="body1" sx={{ mt: 2 }}>
            Этот тип аудита производит автоматизированное сканирование портов
            сетевых хостов с целью выявления уязвимых служб. Сведения об
            уязвимостях, полученные при проведении аудита, носят вероятностный
            характер и требуют дополнительного подтверждения/опроверждения на
            этапе устранения уязвимостей.
          </Typography>
          <Typography variant="body1" sx={{ mt: 2 }}>
            {currentLanguage === "ENG"
              ? `Creation time: ${scanInfo.creation_time}`
              : `Формирование отчета: ${scanInfo.creation_time} `}
          </Typography>
          <Typography variant="body1" sx={{ mt: 2 }}>
            {currentLanguage === "ENG"
              ? `Start/End Scan: ${scanInfo.start_time} / ${scanInfo.end_time}`
              : `Начало/завершение сканирования: ${scanInfo.start_time} / ${scanInfo.end_time}`}
          </Typography>
          <Typography variant="body1" sx={{ mt: 2 }}>
            {currentLanguage === "ENG"
              ? `Hosts: ${scanInfo.target_hosts}`
              : `Хосты: ${scanInfo.target_hosts}`}
          </Typography>
          <Typography variant="body1" sx={{ mt: 2, mb: 1, fontWeight: "bold" }}>
            {" "}
            Таблица распределения уязвимостей по хостам
          </Typography>
          <VulnerabilityTable
            currentLanguage={currentLanguage}
            vulnerabilityData={scanInfo.vulnerabilities}
          />
          <Typography variant="body1" sx={{ mt: 5, mb: 1, fontWeight: "bold" }}>
            {" "}
            Таблица распределения уязвимостей по продуктам
          </Typography>
          <ProductTable
            currentLanguage={currentLanguage}
            vulnerabilityData={scanInfo.products}
          />
          <VulnerabilityDiagram
            vulnerabilityData={scanInfo.vulnerabilities}
            currentLanguage={currentLanguage}
            percent={scanInfo.percent}
          />
        </Box>
      ) : (
        <Typography variant="body1" sx={{ mt: 2 }}>
          {currentLanguage === "ENG"
            ? "No scan information available"
            : "Информация о сканировании недоступна"}
        </Typography>
      )}
    </Box>
  );
});

export default VulerabilityReport;
